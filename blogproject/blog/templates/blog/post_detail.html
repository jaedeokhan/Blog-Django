<!DOCTYPE html>
<html>
  <head>
    {% include "include/header_css.html" %}
    </head>
    <body>
      <!-- Header-->
      {% include "include/header.html" %}
    <section class="py-5">
      <!-- 게시물 상세정보 -->
      <!-- 조회수 증가 -->
      <div class="container text-center">
        <p class="h6 mb-0 text-uppercase text-primary">{{ post.category }}</p>
        <h1>{{ post.title }}</h1>
        <p style="display: none;">{{ post.update_view_count }}</p>
        <span><i class="fas fa-eye" style="color:#4c6ef5;"></i>조회수 : <span class="badge">{{ post.view_count }}</span></span>
        &nbsp;&nbsp;&nbsp;&nbsp;
        <a href="#" class="like" name="{{ post.id }}" value="Like" >
          {% if user in post.likes_user.all %}
          <i class="fas fa-heart alreday" style="color: #c4302b;"></i>
          {% else %}
          <i class="far fa-heart alreday" style="color: #c4302b;"></i>
          {% endif %}
        </a>
        <span id="count-{{ post.id }}">추천수 : <span class="badge">{{ post.likes_user.all.count }}</span></span>
        <ul class="list-inline  mb-0">
          <li class="list-inline-item mr-0 text-muted align-middle">By </li>
          <li class="list-inline-item align-middle mr-0"><a class="font-weight-bold reset-anchor" href="#">{{ post.user }}</a></li>
          <li class="list-inline-item text-muted align-middle mr-0">|</li>
          <li class="list-inline-item text-muted align-middle mr-0">{{ post.create_date }}</li>
          <li class="list-inline-item text-muted align-middle mr-0">|</li>
        </ul>
      </div>
      <div class="text-right">
        {% if user.is_authenticated  %}
          {% if user == post.user %}   
            <a href="{% url 'post-update' post.id %}" class="btn btn-primary">수정</a>
            <a href="{% url 'post-delete' post.id %} " class="btn btn-danger">삭제</a>
          {% endif %}
        {% endif %}
      </div>
      <img class="w-100 py-5" src="/static/img/post-banner.jpg" alt="">
      <div class="container">
        <div class="row">
          <div class="col-lg-8 mb-5 mb-lg-0">
            <!-- <p class="lead first-letter-styled line-height-lg">L orem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus.</p> -->
            <!-- <div class="px-lg-5 mb-5">
              <blockquote class="blockquote-custom">Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua.</blockquote>
            </div> -->
            <h2>{{ post.content }}</h2>
            <!-- <p class="text-muted mb-4">Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata.</p><img class="img-fluid mb-4" src="/static/img/post-img-1.jpg" alt=""> -->
            <!-- <p class="text-muted mb-5">Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata.</p> -->
            <!-- <h3 class="mb-4">Heading level three</h3> -->
            <!-- <ul class="list-check text-muted text-small mb-5">
              <li class="mb-1">Lorem ipsum dolor sit amet, consectetur adipisicing elit.</li>
              <li class="mb-1">Inventore magni sed error dignissimos repudiandae.</li>
              <li class="mb-1">Aperiam cum, nisi sed aliquam soluta amet molestiae.</li>
              <li class="mb-1">Consequatur sequi dolore, doloribus officia Nihil fugit.</li>
            </ul> -->
            {% if post.image %}
            <img class="img-fluid mb-4" src="{{ post.image.url }}" alt="">
            {% else %}
            
            {% endif %}
            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
            <p class="mb-5">Possimus animi modi praesentium quis delectus libero architecto ipsum sint iure amet rerum incidunt, harum facere voluptatibus eligendi. Velit sapiente omnis earum, facilis harum est debitis tenetur deserunt tempora explicabo!</p>
            <div class="p-4 bg-light mb-5">
              <ul class="list-inline mb-0">
                <li class="list-inline-item mr-2 pr-lg-2"><a class="tag reset-anchor" href="#"><i class="fas fa-bookmark text-primary mr-2"></i>Travel</a></li>
                <li class="list-inline-item mr-2 pr-lg-2"><a class="tag reset-anchor" href="#"><i class="fas fa-bookmark text-primary mr-2"></i>Lifestyle</a></li>
                <li class="list-inline-item mr-2 pr-lg-2"><a class="tag reset-anchor" href="#"><i class="fas fa-bookmark text-primary mr-2"></i>Vacation</a></li>
              </ul>
            </div>
            <!-- <h3 class="h4 mb-4">Share this post</h3>
            <ul class="list-inline mb-5">
              <li class="list-inline-item mr-1 mb-3"><a class="social-link-share facebook" href="#"><i class="fab fa-facebook-f mr-2"></i>Share</a></li>
              <li class="list-inline-item mr-1 mb-3"><a class="social-link-share twitter" href="#"><i class="fab fa-twitter mr-2"></i>Tweet</a></li>
              <li class="list-inline-item mr-1 mb-3"><a class="social-link-share instagram" href="#"><i class="fab fa-instagram mr-2"></i>Share</a></li>
            </ul>
            <h3 class="h4 mb-4">Leave a comment</h3>
            <form class="mb-5" action="#">
              <div class="row">
                <div class="form-group col-lg-6">
                  <input class="form-control" type="text" name="name" placeholder="Full Name e.g. Jason Doe">
                </div>
                <div class="form-group col-lg-6">
                  <input class="form-control" type="email" name="email" placeholder="Email Address e.g. Jason@email.com">
                </div>
                <div class="form-group col-lg-12">
                  <textarea class="form-control" name="message" rows="5" placeholder="Leave your message"></textarea>
                </div>
                <div class="form-group col-lg-12">
                  <button class="btn btn-dark" type="submit">Submit your comment</button>
                </div>
              </div>
            </form> -->
            <!-- <h3 class="h4 mb-4 d-flex align-items-center"><span>Comments</span><span class="text-small ml-3 text-gray">- 3 Comments</span></h3> -->
            <!-- <ul class="list-unstyled comments">
              <li>
                <div class="d-flex mb-4">
                  <div class="pr-2 flex-grow-1" style="width: 75px; min-width: 75px;"><img class="rounded-circle shadow-sm img-fluid img-thumbnail" src="/static/img/person-1.jpg" alt=""></div>
                  <div class="pl-2">
                    <p class="small mb-0 text-primary">15 Aug 2019</p>
                    <h5>Jimmy Roy</h5>
                    <p class="text-muted text-small mb-2">Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At.</p><a class="reset-anchor text-small" href="#"><i class="fas fa-share mr-2 text-primary"></i><strong>Reply</strong></a>
                  </div>
                </div>
                <ul class="list-unstyled">
                  <li> 
                    <div class="d-flex mb-4">
                      <div class="pr-2 flex-grow-1" style="width: 75px; min-width: 75px;"><img class="rounded-circle shadow-sm img-fluid img-thumbnail" src="/static/img/person-2.jpg" alt=""></div>
                      <div class="pl-2">
                        <p class="small mb-0 text-primary">19 Sep 2019</p>
                        <h5>Melissa Johanson</h5>
                        <p class="text-muted text-small mb-2">Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At.</p><a class="reset-anchor text-small" href="#"><i class="fas fa-share mr-2 text-primary"></i><strong>Reply</strong></a>
                      </div>
                    </div>
                  </li>
                </ul>
              </li>
              <li>
                <div class="d-flex mb-4">
                  <div class="pr-2 flex-grow-1" style="width: 75px; min-width: 75px;"><img class="rounded-circle shadow-sm img-fluid img-thumbnail" src="/static/img/person-3.jpg" alt=""></div>
                  <div class="pl-2">
                    <p class="small mb-0 text-primary">10 Oct 2019</p>
                    <h5>David Nguyen</h5>
                    <p class="text-muted text-small mb-2">Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At.</p><a class="reset-anchor text-small" href="#"><i class="fas fa-share mr-2 text-primary"></i><strong>Reply</strong></a>
                  </div>
                </div>
              </li>
            </ul> -->
          </div>
         <!-- Sidebar -->
         {% include "include/post_side_bar.html" %}
        </div>
      </div>
    </section>
    {% include "include/footer.html" %}
    <!-- JavaScript files-->
    {% include "include/footer_css.html" %}
    <script>
      $(".like").click(function(){
        var pk = $(this).attr('name')
        $.ajax({
          type: 'POST',
          url: "{% url 'post_like' %}",
          data: {'pk': pk,'csrfmiddlewaretoken': '{{ csrf_token }}' },
          dataType: "json",
          success: function (response) {
            alert(response.message);
            $("#count-" + pk).html("추천수 : <span class='badge'>" + response.likes_count + "</span>");
            var like = $(".like i");
            if(response.is_liked){ // 이미 추천 o
              like.removeClass();
              like.addClass("far fa-heart alreday");
            } else { // 추천 x
              like.removeClass();
              like.addClass("fas fa-heart alreday");
            }
          },
          error: function (request, status, error){
            alert("로그인을 하고 이용해주세요.")
            window.location.replace("/accounts/login/")
          }
        })

      });
    </script>
  </body>
</html>